{% extends 'layout.html' %}

{% block content %}
<div style="padding: 10px;">
    {% with messages = get_flashed_messages() %}
      {% if messages %}
        {% for message in messages %}
          <div style="background: #d4edda; color: #155724; padding: 15px; border-radius: 8px; margin-bottom: 20px; text-align: center; border: 1px solid #c3e6cb;">
            {{ message }}
          </div>
        {% endfor %}
      {% endif %}
    {% endwith %}

    <!-- BOT√ìN MAGICO DE PUBLICACI√ìN -->
    <div class="admin-panel" style="background: #1a1a1a; border: 2px solid #28a745;">
        <h3 style="color: #28a745; margin-top: 0;">üöÄ Control de Publicaci√≥n</h3>
        <p style="font-size: 12px; color: #ccc;">Usa este bot√≥n despu√©s de hacer cambios para que tus clientes vean la web actualizada al instante.</p>
        <form action="/publicar" method="POST">
            <button type="submit" style="background: #28a745; font-weight: bold; padding: 15px;">ACTUALIZAR WEB CLIENTES</button>
        </form>
    </div>

    <a href="/" class="back-link">‚Üê Volver a la App</a>

    <!-- AGREGAR RRPP -->
    <div class="admin-panel">
        <h3 class="admin-title">Agregar RRPP</h3>
        <form method="POST" enctype="multipart/form-data">
            <input type="hidden" name="tipo" value="add_rrpp">
            <div style="display:flex; gap: 15px; margin-bottom: 5px;">
                <div style="width: 80px;">
                    <label style="font-size: 12px; color: #aaa;">Orden</label>
                    <input type="number" name="orden" value="99" style="text-align: center; padding: 12px 5px;">
                </div>
                <div style="flex: 1;">
                    <label style="font-size: 12px; color: #aaa;">Localidad</label>
                    <input type="text" name="localidad" placeholder="Ej: Arenales" required>
                </div>
            </div>
            <label style="font-size: 12px; color: #aaa;">Nombre</label>
            <input type="text" name="nombre" placeholder="Nombre" required>
            <label style="font-size: 12px; color: #aaa;">Link de la Foto (URL)</label>
            <input type="text" name="foto_url" placeholder="https://..." required>
            <input type="text" name="instagram" placeholder="Instagram" required>
            <input type="text" name="whatsapp" placeholder="WhatsApp (sin +)" required>
            <button type="submit">Guardar RRPP</button>
        </form>
    </div>

    <!-- LISTA RRPP -->
    <div class="admin-panel">
        <h3 class="admin-title">Lista de RRPP</h3>
        <table>
            {% for r in rrpps %}
            <tr style="opacity: {% if r.visible %}1{% else %}0.5{% endif %}; border-bottom: 1px solid #333;">
                <td style="color:var(--primary-green); font-weight:bold; padding: 10px 0;">{{ r.orden }}</td>
                <td>
                    <div style="font-weight:bold;">{{ r.nombre }}</div>
                    <div style="font-size:10px;">{{ r.localidad }}</div>
                </td>
                <td style="text-align:right; display:flex; justify-content:flex-end; gap:5px; padding: 10px 0;">
                    <a href="{{ url_for('edit_rrpp', id=r.id) }}" style="background:#4a90e2; color:white; padding:5px 10px; border-radius:5px; text-decoration:none; font-size:10px;">EDIT</a>
                    <form method="POST" style="margin:0;">
                        <input type="hidden" name="tipo" value="toggle"><input type="hidden" name="tabla" value="rrpp"><input type="hidden" name="id" value="{{ r.id }}">
                        <button type="submit" style="background:{% if r.visible %}#f0ad4e{% else %}#999{% endif %}; width:auto; padding:5px 10px; font-size:10px; margin:0;">üëÅÔ∏è</button>
                    </form>
                    <form method="POST" style="margin:0;">
                        <input type="hidden" name="tipo" value="delete"><input type="hidden" name="tabla" value="rrpp"><input type="hidden" name="id" value="{{ r.id }}">
                        <button type="submit" class="btn-danger" style="width:auto; padding:5px 10px; font-size:10px; margin:0;">X</button>
                    </form>
                </td>
            </tr>
            {% endfor %}
        </table>
    </div>

    <!-- AGREGAR TRANSPORTE -->
    <div class="admin-panel">
        <h3 class="admin-title">Agregar Transporte</h3>
        <form method="POST">
            <input type="hidden" name="tipo" value="add_transporte">
            <div style="display:flex; gap: 15px; margin-bottom: 5px;">
                <div style="width: 80px;">
                    <label style="font-size: 12px; color: #aaa;">Orden</label>
                    <input type="number" name="orden" value="99" style="text-align: center; padding: 12px 5px;">
                </div>
                <div style="flex: 1;">
                    <label style="font-size: 12px; color: #aaa;">Ciudad</label>
                    <input type="text" name="ciudad" placeholder="Ciudad" required>
                </div>
            </div>
            <input type="text" name="nombre_taxi" placeholder="Nombre Empresa" required>
            <input type="text" name="dueno" placeholder="Due√±o" required>
            <input type="text" name="descripcion" placeholder="Descripci√≥n" required>
            <input type="text" name="precio" placeholder="Precio" required>
            <input type="text" name="whatsapp" placeholder="WhatsApp" required>
            <button type="submit">Guardar Transporte</button>
        </form>
    </div>

    <!-- CONFIG TEXTOS -->
    <div class="admin-panel">
        <h3 class="admin-title">Textos de la Web</h3>
        <form method="POST">
            <input type="hidden" name="tipo" value="config_textos">
            <label>Logo Texto</label>
            <textarea name="texto_header" rows="2" required>{{ config.texto_header }}</textarea>
            <label>Actualizaci√≥n</label>
            <textarea name="texto_actualizacion" rows="2" required>{{ config.texto_actualizacion }}</textarea>
            <label>Footer</label>
            <textarea name="texto_footer" rows="2" required>{{ config.texto_footer }}</textarea>
            <button type="submit">Actualizar Todo</button>
        </form>
    </div>
</div>
{% endblock %}